name: Build

on:
    push:
    pull_request:

jobs:
    build:
        runs-on: windows-latest
        env:
            BUILDCACHE_DEBUG: 2

        steps:
            - uses: actions/checkout@v4
              with:
                  path: src

            - name: Setup buildcache
              uses: CeetronSolutions/setup-buildcache-action@v1.0

            - name: Setup CMake
              uses: jwlawson/actions-setup-cmake@v1.14
              with:
                  cmake-version: "3.31.0"

            - name: Setup MSVC
              uses: ilammy/msvc-dev-cmd@v1

            - name: Configure CMake
              working-directory: src
              run: cmake -B b -S . -G Ninja -DCMAKE_CXX_COMPILER=cl

            - name: Build
              working-directory: src
              run: cmake --build b --config Release -v
